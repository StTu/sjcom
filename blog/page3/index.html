
<!-- Blog Layout Start -->

<!DOCTYPE html>
<html lang="en">

  
<!-- HEAD Start -->

<head>
  


  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Research page for Stuart James">
  <meta name="author" content="Stuart James">
  <meta name="keywords" content="stuart, james, personal, research">
  <link rel="canonical" href="/blog/page3/">
  <title>{ Stuart James } | Blog</title>

  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

  <!-- Custom CSS -->
  <link href="http://stuart-james.com/css/grayscale.css" rel="stylesheet">
  
  <link href="http://stuart-james.com/css/timeline.css" rel="stylesheet">
  
  <link href="http://stuart-james.com/css/bootstrap-social.css" rel="stylesheet">
  <link href="http://stuart-james.com/css/animate.min.css" rel="stylesheet">
  <!-- Custom Fonts -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="http://stuart-james.com/css/rrssb.css" />
  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
  
    <link rel="shortcut icon" type="image/x-icon" href="http://stuart-james.com/img/favicon.ico">
  

  

  


  <!-- iOS Web App mode -->

  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="apple-touch-icon" sizes="36x36" href="/img/web-app/icon-36p.png">
  <link rel="apple-touch-icon" sizes="48x48" href="/img/web-app/icon-48p.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/img/web-app/icon-72p.png">
  <link rel="apple-touch-icon" sizes="96x96" href="/img/web-app/icon-96p.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/img/web-app/icon-144p.png">
  <link rel="apple-touch-icon" sizes="192x192" href="/img/web-app/icon-192p.png">

  <!-- Android Web App mode -->

  <link rel="manifest" href="/manifest.json">




  
<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">


  



</head>

<!-- HEAD End -->


  <body>

    
<!-- Navigation Start -->

<nav class="navbar navbar-custom navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
        <i class="fa fa-bars"></i>
      </button>
      
        <a class="navbar-brand" href="/">
      
          <div>
            
              <img src="img/black-lab-glass.ico" alt="">
            
            { Stuart James }
          </div>
        </a>
    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse navbar-right navbar-main-collapse">
      <ul class="nav navbar-nav">
        
          <!-- Blog, Post, Tag and Error pages -->
          
            <li>
            
                <a href="/#about"> About </a>
            
            </li>
          
            <li>
            
                <a class="page-scroll" href="/cv/"> Résumé </a>
            
            </li>
          
            <li>
            
              
                <a href="/blog/"> Blog </a>
              
            
            </li>
          
            <li>
            
                <a href="/#newsfeed"> News Feed </a>
            
            </li>
          
            <li>
            
                <a href="/publications/"> Publications </a>
            
            </li>
          
            <li>
            
                <a href="/#contact"> Contact </a>
            
            </li>
          
        
      </ul>
    </div>
  </div>
</nav>

<!-- Navigation End -->


    <section id="page" class="container content-section text-center">

      <div class="row">
        <div class="col-md-10 col-md-offset-1 col-xs-10 col-xs-offset-1">

        

        <h2 id="blog">Blog</h2>


        <div>
          
            
<!-- Post List Start -->

<h3 align="left">
  <strong>07 Jul 2014</strong>
  <small>.
    <a class="category" href="http://stuart-james.com/categories/research.html">
      research
    </a>
  .</small>
  <br class="visible-xs-block">
  <a href="/research/2014/07/07/libsvm-linear-kernel-normalisation.html">
    <strong>libSVM linear kernel normalisation</strong>
  </a>
  <small><a href="/research/2014/07/07/libsvm-linear-kernel-normalisation.html#disqus_thread">Comments</a></small>
  <br class="visible-xs-block">
  </h3>
  <div style="text-align: justify;">
    
                        <div class="image featured wrapper">
                                <img src="http://stuart-james.com//img/blog/fnsys-06-00059-g002.jpg" alt="" />
                            
        <a href="/research/2014/07/07/libsvm-linear-kernel-normalisation.html" class="image featured">

            </a>
                        
                            <div class="image featured cite">
                                    Image taken from <a href="http://toublanc.info/support/support-vector-machines-python">Tou Blanc </a>
                            </div>
                        
                        </div>
    
    <p>I have used a variety of tools for binary, multiclass and even incremental SVM problems, today I found something quite nice in binary case for <a href="http://www.csie.ntu.edu.tw/~cjlin/libsvm/">libSVM</a>, although potentially a source of confusion.</p>
<p>It is common in machine learning to apply a sigmoid function to normalise the boundaries of a problem, this can by empirically defining the upper and lower bound or through experimentation. Within <a href="http://www.csie.ntu.edu.tw/~cjlin/libsvm/">libSVM</a> they do this through experimentation, that is great to save you some time. The only thing to remember is it means through the use of random and cross validation with small sets of data, you are likely to get different results on each run.</p>
<p>So the function to consider is this:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87</pre></td><td class="code"><pre>
<span class="c1">// Cross-validation decision values for probability estimates
</span><span class="k">static</span> <span class="kt">void</span> <span class="n">svm_binary_svc_probability</span><span class="p">(</span>
	<span class="k">const</span> <span class="n">svm_problem</span> <span class="o">*</span><span class="n">prob</span><span class="p">,</span> <span class="k">const</span> <span class="n">svm_parameter</span> <span class="o">*</span><span class="n">param</span><span class="p">,</span>
	<span class="kt">double</span> <span class="n">Cp</span><span class="p">,</span> <span class="kt">double</span> <span class="n">Cn</span><span class="p">,</span> <span class="kt">double</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">probA</span><span class="p">,</span> <span class="kt">double</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">probB</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">nr_fold</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
	<span class="kt">int</span> <span class="o">*</span><span class="n">perm</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">);</span>
	<span class="kt">double</span> <span class="o">*</span><span class="n">dec_values</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">double</span><span class="p">,</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">);</span>

	<span class="c1">// random shuffle
</span>	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="p">(</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="o">-</span><span class="n">i</span><span class="p">);</span>
		<span class="n">swap</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">nr_fold</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="kt">int</span> <span class="n">begin</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="o">/</span><span class="n">nr_fold</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">end</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="o">/</span><span class="n">nr_fold</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">svm_problem</span> <span class="n">subprob</span><span class="p">;</span>

		<span class="n">subprob</span><span class="p">.</span><span class="n">l</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="o">-</span><span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">begin</span><span class="p">);</span>
		<span class="n">subprob</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="k">struct</span> <span class="n">svm_node</span><span class="o">*</span><span class="p">,</span><span class="n">subprob</span><span class="p">.</span><span class="n">l</span><span class="p">);</span>
		<span class="n">subprob</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">double</span><span class="p">,</span><span class="n">subprob</span><span class="p">.</span><span class="n">l</span><span class="p">);</span>
			
		<span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">subprob</span><span class="p">.</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">x</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
			<span class="n">subprob</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
			<span class="o">++</span><span class="n">k</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">subprob</span><span class="p">.</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">x</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
			<span class="n">subprob</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
			<span class="o">++</span><span class="n">k</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="kt">int</span> <span class="n">p_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n_count</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">k</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
			<span class="k">if</span><span class="p">(</span><span class="n">subprob</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="mi">0</span><span class="p">)</span>
				<span class="n">p_count</span><span class="o">++</span><span class="p">;</span>
			<span class="k">else</span>
				<span class="n">n_count</span><span class="o">++</span><span class="p">;</span>

		<span class="k">if</span><span class="p">(</span><span class="n">p_count</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">n_count</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
			<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
				<span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">p_count</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">0</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">n_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
				<span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">p_count</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">n_count</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
				<span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">else</span>
		<span class="p">{</span>
			<span class="n">svm_parameter</span> <span class="n">subparam</span> <span class="o">=</span> <span class="o">*</span><span class="n">param</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">probability</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">nr_weight</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">weight_label</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">double</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">weight_label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=+</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">weight_label</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">weight</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">Cp</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">weight</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">Cn</span><span class="p">;</span>
			<span class="k">struct</span> <span class="n">svm_model</span> <span class="o">*</span><span class="n">submodel</span> <span class="o">=</span> <span class="n">svm_train</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">subprob</span><span class="p">,</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">subparam</span><span class="p">);</span>
			<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">svm_predict_values</span><span class="p">(</span><span class="n">submodel</span><span class="p">,</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">x</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;(</span><span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]));</span> 
				<span class="c1">// ensure +1 -1 order; reason not using CV subroutine
</span>				<span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">*=</span> <span class="n">submodel</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
			<span class="p">}</span>		
			<span class="n">svm_free_and_destroy_model</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">submodel</span><span class="p">);</span>
			<span class="n">svm_destroy_param</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">subparam</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">free</span><span class="p">(</span><span class="n">subprob</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
		<span class="n">free</span><span class="p">(</span><span class="n">subprob</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
	<span class="p">}</span>		
	<span class="n">sigmoid_train</span><span class="p">(</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">,</span><span class="n">dec_values</span><span class="p">,</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">y</span><span class="p">,</span><span class="n">probA</span><span class="p">,</span><span class="n">probB</span><span class="p">);</span>
	<span class="n">free</span><span class="p">(</span><span class="n">dec_values</span><span class="p">);</span>
	<span class="n">free</span><span class="p">(</span><span class="n">perm</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>So if you have few numbers of samples, that is the case in some circumstances then the cross validation is where you hit problems. Of course you can simply re-implement it yourself or you can add a few lines to stop cross validation if the number of samples is too few.&lt;p&gt;<br />&lt;/p&gt;&lt;p&gt;Not the most elegant of code, but for the moment it will do. I choose to completely seperate the two steps as opposed to multiple if’s&lt;/p&gt;&lt;pre class="brush: c++; toolbar: false"&gt;static void svm_binary_svc_probability(</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152</pre></td><td class="code"><pre>	<span class="k">const</span> <span class="n">svm_problem</span> <span class="o">*</span><span class="n">prob</span><span class="p">,</span> <span class="k">const</span> <span class="n">svm_parameter</span> <span class="o">*</span><span class="n">param</span><span class="p">,</span>
	<span class="kt">double</span> <span class="n">Cp</span><span class="p">,</span> <span class="kt">double</span> <span class="n">Cn</span><span class="p">,</span> <span class="kt">double</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">probA</span><span class="p">,</span> <span class="kt">double</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">probB</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">nr_fold</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
	<span class="kt">int</span> <span class="o">*</span><span class="n">perm</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">);</span>
	<span class="kt">double</span> <span class="o">*</span><span class="n">dec_values</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">double</span><span class="p">,</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">);</span>

	<span class="c1">// random shuffle
</span>	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="p">(</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="o">-</span><span class="n">i</span><span class="p">);</span>
		<span class="n">swap</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">nr_fold</span><span class="p">)){</span>
		<span class="kt">int</span> <span class="n">begin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">end</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">;</span>

		<span class="kt">int</span> <span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>

		<span class="k">struct</span> <span class="n">svm_problem</span> <span class="n">subprob</span><span class="p">;</span>

		<span class="n">subprob</span><span class="p">.</span><span class="n">l</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">;</span>
		<span class="n">subprob</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="k">struct</span> <span class="n">svm_node</span><span class="o">*</span><span class="p">,</span><span class="n">subprob</span><span class="p">.</span><span class="n">l</span><span class="p">);</span>
		<span class="n">subprob</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">double</span><span class="p">,</span><span class="n">subprob</span><span class="p">.</span><span class="n">l</span><span class="p">);</span>
			
		<span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">subprob</span><span class="p">.</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">x</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
			<span class="n">subprob</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
			<span class="o">++</span><span class="n">k</span><span class="p">;</span>
		<span class="p">}</span>


		<span class="kt">int</span> <span class="n">p_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n_count</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">k</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
			<span class="k">if</span><span class="p">(</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="mi">0</span><span class="p">)</span>
				<span class="n">p_count</span><span class="o">++</span><span class="p">;</span>
			<span class="k">else</span>
				<span class="n">n_count</span><span class="o">++</span><span class="p">;</span>

		<span class="k">if</span><span class="p">(</span><span class="n">p_count</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">n_count</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
			<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
				<span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">p_count</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">0</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">n_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
				<span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">p_count</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">n_count</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
				<span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">else</span>
		<span class="p">{</span>
			<span class="n">svm_parameter</span> <span class="n">subparam</span> <span class="o">=</span> <span class="o">*</span><span class="n">param</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">probability</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">nr_weight</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">weight_label</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">double</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">weight_label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=+</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">weight_label</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">weight</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">Cp</span><span class="p">;</span>
			<span class="n">subparam</span><span class="p">.</span><span class="n">weight</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">Cn</span><span class="p">;</span>
			<span class="k">struct</span> <span class="n">svm_model</span> <span class="o">*</span><span class="n">submodel</span> <span class="o">=</span> <span class="n">svm_train</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">subprob</span><span class="p">,</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">subparam</span><span class="p">);</span>
			<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">svm_predict_values</span><span class="p">(</span><span class="n">submodel</span><span class="p">,</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">x</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;(</span><span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]));</span> 
				<span class="c1">// ensure +1 -1 order; reason not using CV subroutine
</span>				<span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">*=</span> <span class="n">submodel</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
			<span class="p">}</span>		
			<span class="n">svm_free_and_destroy_model</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">submodel</span><span class="p">);</span>
			<span class="n">svm_destroy_param</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">subparam</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">free</span><span class="p">(</span><span class="n">subprob</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
		<span class="n">free</span><span class="p">(</span><span class="n">subprob</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
	<span class="p">}</span><span class="k">else</span><span class="p">{</span>
		<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">nr_fold</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="kt">int</span> <span class="n">begin</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="o">/</span><span class="n">nr_fold</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">end</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="o">/</span><span class="n">nr_fold</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">nr_fold</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
				<span class="n">begin</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
				<span class="n">end</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="kt">int</span> <span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>
			<span class="k">struct</span> <span class="n">svm_problem</span> <span class="n">subprob</span><span class="p">;</span>

			<span class="n">subprob</span><span class="p">.</span><span class="n">l</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="o">-</span><span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">begin</span><span class="p">);</span>
			<span class="n">subprob</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="k">struct</span> <span class="n">svm_node</span><span class="o">*</span><span class="p">,</span><span class="n">subprob</span><span class="p">.</span><span class="n">l</span><span class="p">);</span>
			<span class="n">subprob</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">double</span><span class="p">,</span><span class="n">subprob</span><span class="p">.</span><span class="n">l</span><span class="p">);</span>
			
			<span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">subprob</span><span class="p">.</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">x</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
				<span class="n">subprob</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">subprob</span><span class="p">.</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">x</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
				<span class="n">subprob</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
				<span class="o">++</span><span class="n">k</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="kt">int</span> <span class="n">p_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n_count</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">k</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
				<span class="k">if</span><span class="p">(</span><span class="n">subprob</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="mi">0</span><span class="p">)</span>
					<span class="n">p_count</span><span class="o">++</span><span class="p">;</span>
				<span class="k">else</span>
					<span class="n">n_count</span><span class="o">++</span><span class="p">;</span>

			<span class="k">if</span><span class="p">(</span><span class="n">p_count</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">n_count</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
				<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
					<span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">p_count</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">0</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">n_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
				<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
					<span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">p_count</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">n_count</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span>
				<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
					<span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
			<span class="k">else</span>
			<span class="p">{</span>
				<span class="n">svm_parameter</span> <span class="n">subparam</span> <span class="o">=</span> <span class="o">*</span><span class="n">param</span><span class="p">;</span>
				<span class="n">subparam</span><span class="p">.</span><span class="n">probability</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
				<span class="n">subparam</span><span class="p">.</span><span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span>
				<span class="n">subparam</span><span class="p">.</span><span class="n">nr_weight</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
				<span class="n">subparam</span><span class="p">.</span><span class="n">weight_label</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
				<span class="n">subparam</span><span class="p">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">Malloc</span><span class="p">(</span><span class="kt">double</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
				<span class="n">subparam</span><span class="p">.</span><span class="n">weight_label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=+</span><span class="mi">1</span><span class="p">;</span>
				<span class="n">subparam</span><span class="p">.</span><span class="n">weight_label</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
				<span class="n">subparam</span><span class="p">.</span><span class="n">weight</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">Cp</span><span class="p">;</span>
				<span class="n">subparam</span><span class="p">.</span><span class="n">weight</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">Cn</span><span class="p">;</span>
				<span class="k">struct</span> <span class="n">svm_model</span> <span class="o">*</span><span class="n">submodel</span> <span class="o">=</span> <span class="n">svm_train</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">subprob</span><span class="p">,</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">subparam</span><span class="p">);</span>
				<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">begin</span><span class="p">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="n">svm_predict_values</span><span class="p">(</span><span class="n">submodel</span><span class="p">,</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">x</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;(</span><span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]));</span> 
					<span class="c1">// ensure +1 -1 order; reason not using CV subroutine
</span>					<span class="n">dec_values</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">*=</span> <span class="n">submodel</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
				<span class="p">}</span>		
				<span class="n">svm_free_and_destroy_model</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">submodel</span><span class="p">);</span>
				<span class="n">svm_destroy_param</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">subparam</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">free</span><span class="p">(</span><span class="n">subprob</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
			<span class="n">free</span><span class="p">(</span><span class="n">subprob</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">sigmoid_train</span><span class="p">(</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">l</span><span class="p">,</span><span class="n">dec_values</span><span class="p">,</span><span class="n">prob</span><span class="o">-&amp;</span><span class="n">gt</span><span class="p">;</span><span class="n">y</span><span class="p">,</span><span class="n">probA</span><span class="p">,</span><span class="n">probB</span><span class="p">);</span>
	<span class="n">free</span><span class="p">(</span><span class="n">dec_values</span><span class="p">);</span>
	<span class="n">free</span><span class="p">(</span><span class="n">perm</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>
<p><br /></p>
<p>As with a lot of my code based posts, this is more for my memory than anything, but hopefully may help people unlock the secrets of <a href="http://www.csie.ntu.edu.tw/~cjlin/libsvm/">libSVM</a>.</p>

  </div>
  <br class="visible-xs-block">

<!-- Post List End -->
          
            
<!-- Post List Start -->

<h3 align="left">
  <strong>24 Jun 2014</strong>
  <small>.
    <a class="category" href="http://stuart-james.com/categories/tech.html">
      tech
    </a>
  .</small>
  <br class="visible-xs-block">
  <a href="/tech/2014/06/24/wolfram-programming-cloud-beta-goes-live.html">
    <strong>Wolfram Programming Cloud Beta goes live</strong>
  </a>
  <small><a href="/tech/2014/06/24/wolfram-programming-cloud-beta-goes-live.html#disqus_thread">Comments</a></small>
  <br class="visible-xs-block">
  </h3>
  <div style="text-align: justify;">
    
    <p>Wolfram Alpha is incredibly useful source of information, when it was announced they would produce a flexible programming cloud it was of great interest to me. With the release I jumped on to see what it was like.</p>
<p>So I played around with a few examples under their free account to see what was possible, then after 5 minutes I thought I would try to put a mini demo up for this blog post. The functionality is quite powerful exploiting rich social media structures, looks really impressive and something I would be interested in exploiting, but as soon as I tried to do something simple I got this:</p>
<p>&lt;img class="img-responsive" style="max-width: 100%;, height: auto;  display: block;"title="image" alt="image" src="http://stuartjames.info/Data/Sites/5/media/wlw/image4_thumb.png"&gt;</p>
<p><!--more--><br /></p>
<p>Where I would draw your attention to:</p>
<p><a href="http://stuartjames.info/Data/Sites/5/media/wlw/image8.png"><img style="display: inline;" title="image" alt="image" src="http://stuartjames.info/Data/Sites/5/media/wlw/image8_thumb.png" /></a></p>
<p>So well the free account is useless… better luck next time Wolfram you didn’t get me addicted to this!</p>
<p><br /><a href="http://stuartjames.info/Journal/wolfram-programming-cloud-beta-goes-live.aspx">Stuart James</a>  <a href="http://stuartjames.info/Journal/wolfram-programming-cloud-beta-goes-live.aspx">…</a></p>

  </div>
  <br class="visible-xs-block">

<!-- Post List End -->
          
            
<!-- Post List Start -->

<h3 align="left">
  <strong>15 May 2014</strong>
  <small>.
    <a class="category" href="http://stuart-james.com/categories/life.html">
      life
    </a>
  .</small>
  <br class="visible-xs-block">
  <a href="/life/2014/05/15/why-you-should-come-to-surrey-university.html">
    <strong>Why you should come to Surrey University</strong>
  </a>
  <small><a href="/life/2014/05/15/why-you-should-come-to-surrey-university.html#disqus_thread">Comments</a></small>
  <br class="visible-xs-block">
  </h3>
  <div style="text-align: justify;">
    
    <iframe width="100%" height="auto" style="max-width: 100%;, height: auto; display: block;" src="http://stuartjames.info//www.youtube.com/embed/CM82ZanYN0A" frameborder="0" allowfullscreen=""></iframe>

<p>And that's all folks!</p>
<p><br /><a href="http://stuartjames.info/Journal/why-you-should-come-to-surrey-university.aspx">Stuart James</a>  <a href="http://stuartjames.info/Journal/why-you-should-come-to-surrey-university.aspx">…</a></p>

  </div>
  <br class="visible-xs-block">

<!-- Post List End -->
          
            
<!-- Post List Start -->

<h3 align="left">
  <strong>15 May 2014</strong>
  <small>.
    <a class="category" href="http://stuart-james.com/categories/climbing.html">
      climbing
    </a>
  .</small>
  <br class="visible-xs-block">
  <a href="/climbing/2014/05/15/intro-to-climbing-@craggyisland.html">
    <strong>Intro to Climbing @CraggyIsland</strong>
  </a>
  <small><a href="/climbing/2014/05/15/intro-to-climbing-@craggyisland.html#disqus_thread">Comments</a></small>
  <br class="visible-xs-block">
  </h3>
  <div style="text-align: justify;">
    
    <p>For the last couple of weeks I have been taking an intro to climbing at Craggy Island in Guildford. I have previously been bouldering at Surrey Sports Park and a Church in Bristol, but have never been bothered to commit to the hassle of ropes. Despite my initial reservations I loved it, I would highly recommend and although the skills you learn on an intro course aren’t ground breaking the climbing anecdotes and titbits are great to listen to.</p>
<p><img style="max-width: 100%;, height: auto; display: block;" title="BMC Leading Ladder Grand Final 2013" alt="BMC Leading Ladder Grand Final 2013" src="http://stuartjames.info/Data/Sites/5/media/wlw/8703216767_c1a22aea02_o_thumb.jpg" /></p>
<p>I have already planned my first post-course climbing trip at Craggy Island!</p>
<p><br /><a href="http://stuartjames.info/Journal/intro-to-climbing-craggyisland.aspx">Stuart James</a>  <a href="http://stuartjames.info/Journal/intro-to-climbing-craggyisland.aspx">…</a></p>

  </div>
  <br class="visible-xs-block">

<!-- Post List End -->
          
            
<!-- Post List Start -->

<h3 align="left">
  <strong>28 Apr 2014</strong>
  <small>.
    <a class="category" href="http://stuart-james.com/categories/running.html">
      running
    </a>
  .</small>
  <br class="visible-xs-block">
  <a href="/running/2014/04/28/10k-colour-run-@weston-super-mare.html">
    <strong>10k Colour Run @Weston-super-Mare</strong>
  </a>
  <small><a href="/running/2014/04/28/10k-colour-run-@weston-super-mare.html#disqus_thread">Comments</a></small>
  <br class="visible-xs-block">
  </h3>
  <div style="text-align: justify;">
    
    <p>Recently I completed a 10k fun run in my home town. The event was in aid of Weston Hospice care, I don’t have any direct relation with it is a good cause to support so raised a little money and went along to get covered in sand. I am not a seasoned runner, but I run in my spare time to keep me a little sane (results not guaranteed). So after 59minutes ish (the event wasn’t timed) of wading through sand/mud I looked like this:</p>
<p><img style="max-width: 50%;, height: auto; display: block;" title="10246545_10152357929296068_5837371472665247184_n" alt="10246545_10152357929296068_5837371472665247184_n" src="http://stuartjames.info/Data/Sites/5/media/wlw/10246545_10152357929296068_5837371472665247184_n_thumb.jpg" /></p>
<p>Although not the most flattering of picture was a great fun experience. I hope to drag others along next year!</p>
<p><br /><a href="http://stuartjames.info/Journal/10k-colour-run-weston-super-mare.aspx">Stuart James</a>  <a href="http://stuartjames.info/Journal/10k-colour-run-weston-super-mare.aspx">…</a></p>

  </div>
  <br class="visible-xs-block">

<!-- Post List End -->
          
        </div>

        
<!-- Pagination Links Start -->

<div class="pagination">

  <h4>

  
    <a href="/blog/page2/" class="previous">Newer Posts</a>
  

  
    |
  

  
    <a href="/blog/page4/" class="next">Older Posts</a>
  

  </h4>

</div>

<!-- Pagination Links End -->


        </div>
      </div>
    </section>

    <!-- Footer Start -->

<footer>

    <!-- Social Buttons Start -->

<ul class="list-inline social-buttons">
    
    <li><a href="https://facebook.com/StuartAaronJames" target="_blank"><i class="fa fa-facebook fa-fw"></i></a></li>
    
    <li><a href="https://twitter.com/StTuJames" target="_blank"><i class="fa fa-twitter fa-fw"></i></a></li>
    
    <li><a href="https://github.com/StTuJames" target="_blank"><i class="fa fa-github fa-fw"></i></a></li>
    
    <li><a href="/feed.xml" target="_blank"><i class="fa fa-rss fa-fw"></i></a></li>
    
    
</ul>

<!-- Social Buttons End -->


    <p><br><br></p>

    <div class="container text-center">
        <p>Copyright &copy; Stuart James 2017</p>
        
    </div>
</footer>

<p><br><br><br></p>

<!-- Footer End -->


    
<!-- Javascript Start -->

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<!-- Plugin JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>

<!-- Custom Theme JavaScript -->
<!--* Start Bootstrap - Grayscale Bootstrap Theme (http://startbootstrap.com)
* Code licensed under the Apache License v2.0.
* For details, see http://www.apache.org/licenses/LICENSE-2.0.-->
<script>
function toggleNavCollapse(){50<$(".navbar").offset().top?$(".navbar-fixed-top").addClass("top-nav-collapse"):$(".navbar-fixed-top").removeClass("top-nav-collapse");}
$(document).ready(toggleNavCollapse);
$(window).scroll(toggleNavCollapse);$(function(){$("a.page-scroll").bind("click",function(b){var a=$(this);$("html, body").stop().animate({scrollTop:$(a.attr("href")).offset().top-50},1500,"easeInOutExpo",function(){a.blur()});b.preventDefault()})});$(".navbar-collapse ul li a").click(function(){$(".navbar-toggle:visible").click()});
</script>













<script>
function addTohistory() {
  if (!window.location.host.startsWith("127.0.0.1")) {
    history.pushState({}, 'Blog', 'http://stuart-james.com/blog/page3/');
  }
}
</script>

<!-- Gesture Navigation / Swipe Instruction Start -->


  

  

    <!-- Blog Gesture Navigation Start -->

    <script type="text/javascript" src="/js/hammer.min.js"></script>

    <script>
      var page = document.getElementById('page');

      new Hammer(page).on('swipeleft', function(event) {
        addTohistory();
        
          document.location.replace("/blog/page4/");
        
      });
      new Hammer(page).on('swiperight', function(event) {
        addTohistory();
        
          document.location.replace("/blog/page2/");
        
      });
    </script>

    <!-- Blog Gesture Navigation Start -->

  

  

    <!-- Swipe Instructions for Blog Start -->

    <script>
      $(document).ready(function(){
        if(!localStorage.getItem('blog-swipeshowed')){
          $("#swipe-instruction").fadeIn();
          $("#swipe-instruction .close-swipe-instruction").click(function(){
            $("#swipe-instruction").fadeOut();
          });
          localStorage.setItem('blog-swipeshowed', true);
        }
      });
    </script>

    <!-- Swipe Instructions for Blog End -->

  

  

<!-- Gesture Navigation / Swipe Instruction End -->


<script src="/js/wow.min.js"></script>
<!-- Javascript End -->


  </body>
</html>

<!-- Blog Layout End -->
